require 'socket'
require 'timeout'

class Connect
  def initialize(host)
    @host = host
  end
  
  def check
    @host.each do |h|
    ip, port = h.split(":") #split the string to get the ip and the port
    begin
      Timeout::timeout(5) do #5 seconds should be enough to determine whether the destination will connect
      begin
        target = TCPSocket.new(ip, port) #create a socket connection out of the ip and the port
        target.close
        return true
      rescue Errno::ECONNREFUSED, Errno::EHOSTUNREACH #false if failed to connect
        return false
      end
    end
    return false #timed out
  end
end
end
end
